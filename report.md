# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk](#l-1-centralization-risk)
  - [L-2: Unsafe ERC20 Operation](#l-2-unsafe-erc20-operation)
  - [L-3: Modifier Invoked Only Once](#l-3-modifier-invoked-only-once)
  - [L-4: Empty Block](#l-4-empty-block)
  - [L-5: Missing Inheritance](#l-5-missing-inheritance)
  - [L-6: Unchecked Return](#l-6-unchecked-return)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 8 |
| Total nSLOC | 270 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/StrategyManager.sol | 25 |
| src/YieldAggregator.sol | 176 |
| src/adapters/AaveV3Adapter.sol | 5 |
| src/adapters/CompoundV3Adapter.sol | 37 |
| src/interfaces/IComet.sol | 6 |
| src/interfaces/IProtocolAdapter.sol | 10 |
| src/interfaces/IStrategyManager.sol | 9 |
| src/libraries/OracleLib.sol | 2 |
| **Total** | **270** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 0 |
| Low | 6 |


# Low Issues

## L-1: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>3 Found Instances</summary>


- Found in src/YieldAggregator.sol [Line: 50](src/YieldAggregator.sol#L50)

	```solidity
	contract YieldAggregator is ReentrancyGuard, Ownable {
	```

- Found in src/YieldAggregator.sol [Line: 171](src/YieldAggregator.sol#L171)

	```solidity
	    function withdrawETH(address payable to, uint256 amount) external nonReentrant onlyOwner {
	```

- Found in src/YieldAggregator.sol [Line: 179](src/YieldAggregator.sol#L179)

	```solidity
	        onlyOwner
	```

</details>



## L-2: Unsafe ERC20 Operation

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>1 Found Instances</summary>


- Found in src/adapters/CompoundV3Adapter.sol [Line: 52](src/adapters/CompoundV3Adapter.sol#L52)

	```solidity
	        IERC20(token).transferFrom(msg.sender, address(this), amount);
	```

</details>



## L-3: Modifier Invoked Only Once

Consider removing the modifier or inlining the logic into the calling function.

<details><summary>2 Found Instances</summary>


- Found in src/YieldAggregator.sol [Line: 130](src/YieldAggregator.sol#L130)

	```solidity
	    modifier validAmount(uint256 amount) {
	```

- Found in src/YieldAggregator.sol [Line: 140](src/YieldAggregator.sol#L140)

	```solidity
	    modifier validToken(address token) {
	```

</details>



## L-4: Empty Block

Consider removing empty blocks.

<details><summary>4 Found Instances</summary>


- Found in src/StrategyManager.sol [Line: 39](src/StrategyManager.sol#L39)

	```solidity
	    function _findBestYield(address token, uint256 amount) internal view returns (string memory protocol, uint256 apy) {
	```

- Found in src/StrategyManager.sol [Line: 44](src/StrategyManager.sol#L44)

	```solidity
	    function _calculateSwitchBenefit(address user, uint256 positionIndex, string memory newProtocol)
	```

- Found in src/StrategyManager.sol [Line: 52](src/StrategyManager.sol#L52)

	```solidity
	    function _isProtocolSafe(string memory protocol) internal view returns (bool) {}
	```

- Found in src/adapters/AaveV3Adapter.sol [Line: 13](src/adapters/AaveV3Adapter.sol#L13)

	```solidity
	    function deposit(uint256 amount, address token) external returns (uint256 shares) {}
	```

</details>



## L-5: Missing Inheritance

There is an interface / abstract contract that is potentially missing (not included in) the inheritance of this contract.

<details><summary>1 Found Instances</summary>


- Found in src/StrategyManager.sol [Line: 10](src/StrategyManager.sol#L10)

	Is this contract supposed to implement an interface? Consider extending one of the following: IStrategyManager
	```solidity
	contract StrategyManager {
	```

</details>



## L-6: Unchecked Return

Function returns a value but it is ignored. Consider checking the return value.

<details><summary>4 Found Instances</summary>


- Found in src/StrategyManager.sol [Line: 20](src/StrategyManager.sol#L20)

	```solidity
	        _findBestYield(token, amount);
	```

- Found in src/StrategyManager.sol [Line: 28](src/StrategyManager.sol#L28)

	```solidity
	        _calculateSwitchBenefit(user, positionIndex, newProtocol);
	```

- Found in src/StrategyManager.sol [Line: 32](src/StrategyManager.sol#L32)

	```solidity
	        _isProtocolSafe(protocol);
	```

- Found in src/adapters/CompoundV3Adapter.sol [Line: 52](src/adapters/CompoundV3Adapter.sol#L52)

	```solidity
	        IERC20(token).transferFrom(msg.sender, address(this), amount);
	```

</details>



